function addDefs(svg){
  const defs = document.createElementNS('http://www.w3.org/2000/svg','defs');

  // angle of the stair stripes; if it looks mirrored, flip to -30.
  const STAIR_ROT = 30;

  const pat = document.createElementNS('http://www.w3.org/2000/svg','pattern');
  pat.setAttribute('id','stairsPattern');

  // Scale the pattern to each balcony's box so we always get EXACTLY 3 lines
  pat.setAttribute('patternUnits','objectBoundingBox');
  pat.setAttribute('patternContentUnits','objectBoundingBox');
  pat.setAttribute('width','1');
  pat.setAttribute('height','1');

  // rotate around the center of the tile to align with the iso edges
  pat.setAttribute('patternTransform',`rotate(${STAIR_ROT} 0.5 0.5)`);

  // white background
  const bg = document.createElementNS('http://www.w3.org/2000/svg','rect');
  bg.setAttribute('x','0'); bg.setAttribute('y','0');
  bg.setAttribute('width','1'); bg.setAttribute('height','1');
  bg.setAttribute('fill','#ffffff');
  pat.appendChild(bg);

  // EXACTLY THREE stripes (use rects so width is relative to the object box)
  const STRIPE_COLOR = 'rgba(0,0,0,0.55)';
  const STRIPE_W = 0.03;   // ~3% of the box â†’ nice thin lines
  const xs = [0.18, 0.50, 0.82];  // three positions across the box

  xs.forEach(x => {
    const r = document.createElementNS('http://www.w3.org/2000/svg','rect');
    r.setAttribute('x', x - STRIPE_W/2);
    r.setAttribute('y', '0');
    r.setAttribute('width', STRIPE_W);
    r.setAttribute('height', '1');
    r.setAttribute('fill', STRIPE_COLOR);
    pat.appendChild(r);
  });

  defs.appendChild(pat);
  svg.appendChild(defs);
}
