<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wohnungsübersicht – Am Zug</title>
  <style>
    body{margin:0;font-family:sans-serif;background:#eef4f8;color:#233441}
    .wrap{max-width:1400px;margin:22px auto;padding:12px}
    .panel{background:#f1f3f5;border-radius:14px;box-shadow:0 6px 20px rgba(0,0,0,.08);padding:18px 22px}
    .controls{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:16px}
    .field label{display:block;font-size:12px;color:#6b7b86;margin-bottom:4px}
    select{width:100%;padding:6px 8px;border-radius:6px;border:1px solid #cfd7dd}
    .grid{display:grid;grid-template-columns:1fr 2fr;gap:18px;align-items:start}
    table{width:100%;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden}
    thead{background:#2d3f4d;color:#fff}
    th,td{padding:8px 10px;font-size:14px;border-bottom:1px solid #e0e6eb;text-align:left}
    tr:hover, tr.active{background:#f8fbfd}
    .map-container{background:#fff;border-radius:12px;border:1px solid #dfe6eb;padding:10px;display:flex;align-items:center;justify-content:center;height:100%}
    svg{width:100%;height:100%}
    .legend{display:flex;gap:14px;justify-content:flex-end;margin-top:10px;font-size:13px;color:#6b7b86}
    .legend .sq{width:12px;height:12px;border-radius:2px}
    .sq.ok{background:#5BBE7C}.sq.warn{background:#F5B942}.sq.no{background:#E17575}
    .dot{display:inline-block;width:10px;height:10px;border-radius:50%}
    .dot.available{background:#5BBE7C}
    .dot.reserved{background:#F5B942}
    .dot.rented{background:#E17575}

    .unit-block{transition:filter .18s ease, transform .18s ease; cursor:pointer}
    .unit-block.highlight{filter:saturate(1.8) brightness(1.06); transform:translateY(-2px)}
    .row-highlight{background:#fff7d6 !important; box-shadow:inset 0 0 0 2px #f5b94240}

    /* Balconies: no outline for colored ones */
    .balcony polygon{stroke:none; stroke-width:0}
    .balcony polygon[fill="none"]{stroke:rgba(0,0,0,0.1); stroke-width:2}
    .balcony.highlight polygon{filter:saturate(1.8) brightness(1.06)}
  </style>
</head>
<body>
<div class="wrap">
  <div class="panel">
    <h1>Wohnungen</h1>
    <div class="controls">
      <div class="field"><label>Etage</label><select id="floorSel"></select></div>
      <div class="field"><label>Status</label><select id="statusSel">
        <option value="all">Alle</option>
        <option value="available">Verfügbar</option>
        <option value="reserved">Reserviert</option>
        <option value="rented">Vermietet</option>
      </select></div>
      <div class="field"><label>Zimmer</label><select id="roomsSel"></select></div>
    </div>
    <div class="grid">
      <div>
        <table>
          <thead>
            <tr>
              <th>Nr.</th>
              <th>Zimmer</th>
              <th>Etage</th>
              <th>m²</th>
              <th>Status</th>
              <th>Factsheet</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>
      <div>
        <div class="map-container">
          <svg id="buildingSvg" viewBox="0 0 1600 900"></svg>
        </div>
        <div class="legend"><span class="sq ok"></span> Verfügbar <span class="sq warn"></span> Reserviert <span class="sq no"></span> Vermietet</div>
      </div>
    </div>
  </div>
</div>

<script>
/* === Hardcoded baseline (overwritten by Google Sheet) === */
const DATA=[];
for(let i=1;i<=7;i++){DATA.push({id:`1.${i}`,rooms:2.5,level:1,m2:56,status:"available"});}
for(let i=1;i<=14;i++){DATA.push({id:`2.${i}`,rooms:1.5,level:2,m2:32.3,status:"available"});}
for(let i=1;i<=3;i++){DATA.push({id:`3.${i}`,rooms:2.5,level:3,m2:56,status:"available"});}

/* === Google Sheet sync (id,status,factsheet) === */
const STATUS_CSV = "https://docs.google.com/spreadsheets/d/1-oeqRNM-CxGaILY7FNWaNMgC9ccBWDZDw_
